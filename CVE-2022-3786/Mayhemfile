# Start of a brand new YAML document. You can save this file as Mayhemfile

# version (Optional)
# Datatype: string
# Specifies the version of Mayhem.
version: '2.0'

# Owner (optional) and Project (Required)
# Datatype: string
# The unique name of the project organization and project the target belongs to.
# project: owner/projectname (optional - remove comment to use)
project: whatthefuzz/openssl

# Target (Required)
# Datatype: string
# The name of the target you are testing. A single target could have multiple
# targets.
target: openssl

# image
# Datatype: string
# image is the name of the Docker image that will be used. The image can
# contain the targets (if using Docker packaging) or they may be contained in a
# root/ folder, in which case they are overlayed into the image (see mayhem
# package command). If image is not specified, ForAllSecure’s default Docker
# image based on Debian buster will be used: $MAYHEM_DOCKER_REGISTRY/forallsecure/
# debian-buster. Docker images can be uploaded to mayhem. To more easily refer to
# Docker images that have been uploaded to Mayhem, the $MAYHEM_DOCKER_REGISTRY
# variable can be used to reference the location of the server’s internal docker
# registry. Mayhem comes with ForAllSecure's default image preinstalled.
image: whatthefuzz/openssl-cve-2022-3768:latest
# Default: $MAYHEM_DOCKER_REGISTRY/forallsecure/debian-buster
# Default changed in 1.1
# Introduced in 0.5

# duration
# Datatype: integer
# Time in seconds to run the application.
# duration: 90

# advanced_triage
# Datatype: boolean
# Runs additional analysis via extra test case processing to find defects
# that do not raise a UNIX signal, such as memory leaks or using an uninitialized variable.
advanced_triage: false # Default: false
# Introduced in 1.0

# tasks
# datatype: object
# Sets the explicit tasks that will be executed for the Mayhem run. The `tasks` parameter can be set to include the following tasks: Exploitability Factors, Behavior Testing, Regression Testing, Coverage Analysis.
tasks:
  - name: exploitability_factors
  - name: regression_testing
  - name: behavior_testing

# testsuite
# datatype: list of strings
# Defines the location of the seed test suite for Mayhem runs. The `tests` parameter accepts multiple methods for specifying the seed tests location for the current Mayhem run. In addition, when setting a local test suite directive, Mayhem will upload the test suite as a tar file to the Mayhem instance and substitute the Mayhemfile with an updated URL to the uploaded test suite file. If no test suite values are set via the source Mayhemfile, Mayhem will set [default test suite values](#default-values).
testsuite:
  - file://input

# uid
# Datatype: integer
# An optional numeric UNIX user id to use as the target uid. If unset, an
# unprivileged UNIX user id will be used that could cause issues accessing files.
# If a uid other than 0 is used, the target will generally not be able to perform
# privileged operations such as bind to a port lower than 1024. Docker defaults this
# to 0, although it can be overridden by the USER command. If using the default base
# image, this is 1000.
uid: 0 # Default: derived from ''image''

# gid
# Datatype: integer
# An optional numeric UNIX group id to use as the target gid. If unset, an
# unprivileged UNIX group id will be used that could cause issues accessing files.
# If unspecified, the gid is inherited from the base image. Docker defaults this to
# 0, although it can be overridden by the USER command. If using the default base
# image, this is 1000.
gid: 0 # Default: derived from ''image''

# cmds (Required)
# Datatype: dictionary
# A list of cmd objects to specify the different ways to test the packaged
# application.
# Each *cmd* object tells Mayhem how to analyze the target executable.
# Each *cmd* object contains the following *optional* fields that should only be
# used if the target requires additional information or changes to its environment
# prior to execution
cmds:

  # cmd (Required)
  # datatype: string
  # Invocation of the target executable
  - cmd: /harness/harness @@
    max_length: 50000000
    env: { "LD_PRELOAD": "/lib32/libasan.so.6",
           "LD_LIBRARY_PATH": "/lib32" }

  # timeout
  # datatype: number
  # The time (in seconds) for Mayhem to wait for a single test to complete.
    timeout: 5 # Default: automatic

  # memory_limit
  # datatype: integer
  # maximum amount of memory (in MB) to allow the target to allocate. Mayhem will
  # kill a test run that goes above this memory limit and reports it as a crash.
    memory_limit: 8192 # Default: automatic

  # sanitizer
  # datatype: boolean
  # Set to true *only* if the target executable is compiled with a sanitizer
    sanitizer: true # Default: automatic
  # Added in 1.4

  # afl
  # datatype: boolean
  # Set to true *only* if the target executable is compiled with AFL instrumentation.
    afl: true # Default: automatic
  # Default changed in 1.1
